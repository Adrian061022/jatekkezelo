<div class="home-container">
  <div class="container">
    <div class="header">
      <h1>üéÆ Game Library</h1>
      <p *ngIf="total > 0" class="game-count">{{ total }} games available</p>
    </div>

    <!-- Filters Section -->
    <div class="filters-section">
      <div class="filters-row">
        <!-- Search Box -->
        <div class="filter-group search-box">
          <input 
            type="text" 
            [(ngModel)]="searchQuery" 
            (input)="onSearchChange()"
            placeholder="üîç Search games..."
            class="filter-input"
          />
        </div>

        <!-- Category Filter -->
        <div class="filter-group">
          <select 
            [(ngModel)]="selectedCategoryId" 
            (change)="onCategoryChange()"
            class="filter-select"
          >
            <option [value]="undefined">All Categories</option>
            <option *ngFor="let category of categories" [value]="category.id">
              {{ category.name }}
            </option>
          </select>
        </div>

        <!-- Sort By -->
        <div class="filter-group">
          <select 
            [(ngModel)]="sortBy" 
            (change)="onSortChange()"
            class="filter-select"
          >
            <option value="created_at">Sort by: Newest</option>
            <option value="title">Sort by: Title</option>
            <option value="price">Sort by: Price</option>
          </select>
        </div>

        <!-- Sort Order -->
        <div class="filter-group">
          <select 
            [(ngModel)]="sortOrder" 
            (change)="onSortChange()"
            class="filter-select"
          >
            <option value="desc">{{ sortBy === 'price' ? 'High to Low' : sortBy === 'title' ? 'Z to A' : 'Newest First' }}</option>
            <option value="asc">{{ sortBy === 'price' ? 'Low to High' : sortBy === 'title' ? 'A to Z' : 'Oldest First' }}</option>
          </select>
        </div>

        <!-- Clear Filters -->
        <button 
          (click)="clearFilters()" 
          class="btn btn-clear"
          *ngIf="searchQuery || selectedCategoryId || sortBy !== 'created_at' || sortOrder !== 'desc'"
        >
          Clear Filters
        </button>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading">
      <div class="spinner"></div>
      <p>Loading games...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="errorMessage && !isLoading" class="error-message">
      {{ errorMessage }}
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && games.length === 0 && !errorMessage" class="empty-state">
      <div class="empty-icon">üì¶</div>
      <h2>No games found</h2>
      <p *ngIf="searchQuery || selectedCategoryId">Try adjusting your filters</p>
      <p *ngIf="!searchQuery && !selectedCategoryId">Be the first to add a game!</p>
      <a *ngIf="authService.isLoggedIn && isAdmin && !searchQuery && !selectedCategoryId" routerLink="/admin/game/create" class="btn btn-primary">
        Add Your First Game
      </a>
    </div>

    <!-- Games Grid -->
    <div *ngIf="!isLoading && games.length > 0" class="games-grid">
      <div *ngFor="let game of games" class="game-card" (click)="viewGame(game.id)">
        <div class="game-image">
          <img 
            [src]="game.cover_image || 'https://via.placeholder.com/460x215/1a1a2e/16213e?text=No+Image'" 
            [alt]="game.title"
            loading="lazy"
          />
          <div class="game-overlay">
            <span class="view-details">View Details</span>
          </div>
        </div>
        
        <div class="game-info">
          <h3 class="game-title">{{ game.title }}</h3>
          <p class="game-category">{{ game.category.name }}</p>
          <div class="game-footer">
            <span class="game-price">${{ game.price }}</span>
            <button 
              *ngIf="isAdmin" 
              (click)="deleteGame(game.id, game.title); $event.stopPropagation()" 
              class="btn-delete"
              title="Delete game"
            >
              üóëÔ∏è
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div *ngIf="!isLoading && games.length > 0 && lastPage > 1" class="pagination">
      <button 
        (click)="previousPage()" 
        [disabled]="currentPage === 1"
        class="btn btn-secondary"
      >
        ‚Üê Previous
      </button>
      
      <span class="page-info">
        Page {{ currentPage }} of {{ lastPage }}
      </span>
      
      <button 
        (click)="nextPage()" 
        [disabled]="currentPage === lastPage"
        class="btn btn-secondary"
      >
        Next ‚Üí
      </button>
    </div>
  </div>
</div>
